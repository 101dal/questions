<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Master - R√©vision Locale</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>

<body data-theme="light">
    <div class="container">
        <h1 class="main-title">Quiz Master</h1>

        <!-- √âcran 1: Tableau de Bord -->
        <div id="dashboard-screen" class="screen active">
            <!-- NOUVEAU: Section Objectif Quotidien -->
            <div id="daily-goal-section" class="card daily-goal-card hidden">
                <h3>Objectif Quotidien</h3>
                <div id="daily-goal-progress">
                    <p>Objectif: <span id="goal-target-display">--</span> | Progr√®s: <span
                            id="goal-progress-display">0</span></p>
                    <div class="progress-bar-container goal-progress-bar-container">
                        <div id="goal-progress-bar"></div>
                    </div>
                    <p id="goal-message" class="goal-message-text"></p>
                </div>
            </div>

            <div class="card">
                <h2>1. Importer / Choisir / Cr√©er</h2>
                <label class="file-input-label">
                    <span>Choisir un fichier .json ou glisser-d√©poser ici...</span>
                    <input type="file" id="file-input" accept=".json">
                </label>
                <div id="drag-drop-overlay" class="drag-drop-zone">Rel√¢chez pour charger</div>
                <div class="form-group url-import-group">
                    <label for="url-input">Ou importer depuis une URL :</label>
                    <div class="input-button-group">
                        <input type="url" id="url-input" placeholder="https://exemple.com/quiz.json">
                        <button id="import-url-btn" class="btn-secondary">Importer</button>
                    </div>
                </div>
                <!-- NOUVEAU: Bouton Cr√©er/√âditer -->
                <div class="dashboard-actions">
                    <button id="go-to-editor-btn" class="btn-secondary">Cr√©er / √âditer un Quiz</button>
                </div>
                <p id="file-error" class="error-message hidden"></p>
                <p id="file-success" class="success-message hidden"></p>

                <h2 class="h2-subsection">2. Biblioth√®que Locale</h2>
                <!-- NOUVEAU: Recherche Biblioth√®que -->
                <div class="form-group library-search-group">
                    <label for="library-search-input" class="visually-hidden">Rechercher dans la biblioth√®que</label>
                    <input type="search" id="library-search-input" placeholder="Rechercher un quiz...">
                </div>
                <div id="quiz-library">
                    <p>Aucun quiz dans la biblioth√®que. Importez ou cr√©ez-en un !</p>
                    <!-- La liste des quiz sera g√©n√©r√©e ici par JS -->
                    <!-- Exemple d'item g√©n√©r√© par JS avec nouveaux boutons:
                    <div class="quiz-library-item" data-quiz-id="unique_id_123">
                        <span class="quiz-title">Titre du Quiz Exemple</span>
                        <div class="quiz-item-actions">
                            <span class="quiz-source">local</span>
                            <button class="edit-quiz-btn btn-icon" title="√âditer ce quiz">‚úèÔ∏è</button>
                            <button class="export-single-quiz-btn btn-icon" title="Exporter ce quiz (.json)">üíæ</button>
                            <button class="delete-quiz-btn btn-icon" title="Supprimer de la biblioth√®que">‚úñ</button>
                        </div>
                    </div>
                     -->
                </div>
            </div>

            <div id="config-options" class="card hidden">
                <h2>3. Configurer la Session</h2>
                <div class="config-section">
                    <label><input type="radio" name="quiz-mode" value="preset-short" checked><span>Preset:
                            Rapide</span></label>
                    <label><input type="radio" name="quiz-mode" value="preset-medium"><span>Preset: Moyen</span></label>
                    <label><input type="radio" name="quiz-mode" value="preset-long"><span>Preset: Long</span></label>
                    <label><input type="radio" name="quiz-mode" value="all"><span>Toutes les questions</span></label>
                    <label class="has-extra-input">
                        <input type="radio" name="quiz-mode" value="errors">
                        <span>üéØ Rejouer erreurs des</span>
                        <input type="number" id="error-sessions-count" value="3" min="1" class="inline-number-input">
                        <span>derni√®res sessions</span>
                    </label>
                    <label><input type="radio" name="quiz-mode" value="exam"><span>‚è±Ô∏è Mode Examen Blanc</span></label>
                    <!-- NOUVEAU: Mode Flashcard -->
                    <label><input type="radio" name="quiz-mode" value="flashcard"><span>üóÇÔ∏è Mode Flashcard
                            (Auto-√©valuation)</span></label>
                    <!-- TODO: Ajouter Mode R√©vision SRS quand impl√©ment√© -->
                    <!-- <label><input type="radio" name="quiz-mode" value="srs"><span>üß† R√©vision Espac√©e</span></label> -->
                    <label><input type="radio" name="quiz-mode" value="custom"><span>Personnalis√©:</span></label>
                    <div id="custom-settings" class="hidden">
                        <label for="custom-time">Temps (min):</label>
                        <input type="number" id="custom-time" min="1" placeholder="Libre si vide">
                        <label for="custom-questions">Nb Questions:</label>
                        <input type="number" id="custom-questions" min="1" placeholder="Toutes">
                    </div>
                </div>
                <div class="config-extra-options">
                    <label class="checkbox-label"><input type="checkbox" id="allow-navigation-checkbox"><span>Permettre
                            navigation/correction arri√®re</span></label>
                    <label class="checkbox-label"><input type="checkbox" id="instant-feedback-checkbox"
                            checked><span>Feedback instantan√© (Correct/Incorrect)</span></label>
                    <label class="checkbox-label indented-option"><input type="checkbox"
                            id="show-expl-on-incorrect"><span>‚Ü≥ Afficher explication/r√©ponse si incorrect</span></label>
                </div>
                <button id="start-quiz-btn" class="btn-primary btn-large">Lancer la Session</button>
            </div>

            <div id="score-history-section" class="card">
                <!-- Contenu Historique inchang√© -->
            </div>
        </div>

        <!-- √âcran 2: Quiz en cours -->
        <div id="quiz-screen" class="screen hidden">
            <div id="quiz-header" class="card sticky-header">
                <!-- Contenu Header inchang√© -->
            </div>
            <div id="quiz-content-area">
                <!-- Les blocs de questions s'afficheront ici -->
                <!-- Exemple bloc pour flashcard (√©l√©ments ajout√©s/modifi√©s par JS) -->
                <!--
                <div class="question-block flashcard-mode">
                     <div class="question-text">...</div>
                     <div id="flashcard-answer-area" class="hidden">
                         <p class="correct-answer-text">Bonne r√©ponse: ...</p>
                         <p class="explanation">Explication: ...</p>
                     </div>
                     <div id="flashcard-controls">
                        <button class="btn-secondary show-answer-btn">Montrer la R√©ponse</button>
                        <div class="flashcard-evaluation-buttons hidden">
                            <button class="flashcard-eval-btn" data-eval="incorrect">Incorrect</button>
                             Ajouter bouton "Difficile/Correct/Facile" pour SRS
                            <button class="flashcard-eval-btn" data-eval="correct">Correct</button>
                        </div>
                     </div>
                 </div>
                 -->
            </div>
            <!-- NOUVEAU: Conteneur s√©par√© pour les boutons flashcard (si affich√©s en bas) -->
            <div id="quiz-flashcard-footer-controls" class="card hidden">
                <!-- Les boutons 'Montrer R√©ponse' ou d'√©valuation pourraient aller ici -->
            </div>

            <button id="finish-quiz-btn" class="btn-primary finish-button hidden">Voir les R√©sultats</button>
            <button id="cancel-quiz-btn" class="btn-secondary cancel-button">Abandonner la Session</button>
        </div>

        <!-- √âcran 3: R√©sultats -->
        <div id="results-screen" class="screen hidden">
            <!-- Contenu R√©sultats inchang√© -->
        </div>

        <!-- √âcran 4: Param√®tres & Statistiques Locales -->
        <div id="settings-screen" class="screen hidden">
            <div class="card">
                <h2>Param√®tres & Statistiques Locales</h2>
                <div class="settings-section">
                    <h3>Param√®tres</h3>
                    <div class="settings-group">
                        <label for="theme-select">Th√®me Visuel:</label>
                        <select id="theme-select">...</select>
                    </div>
                    <div class="settings-group">
                        <label class="checkbox-label"><input type="checkbox" id="sound-effects-toggle"
                                checked><span>Activer les effets sonores</span></label>
                    </div>
                    <!-- NOUVEAU: Param√®tres Objectif Quotidien -->
                    <div class="settings-group">
                        <label for="daily-goal-type">Objectif Quotidien:</label>
                        <select id="daily-goal-type">
                            <option value="none">Aucun</option>
                            <option value="questions">Questions R√©pondues</option>
                            <option value="points">Points Gagn√©s</option>
                            <option value="time">Temps Pass√© (min)</option>
                        </select>
                        <label for="daily-goal-value" class="visually-hidden">Valeur Objectif</label>
                        <input type="number" id="daily-goal-value" min="1" value="20" style="width: 80px;"
                            class="hidden">
                    </div>
                </div>
                <div class="settings-section">
                    <h3>Gestion des Donn√©es Locales</h3>
                    <!-- Contenu Gestion Donn√©es inchang√© -->
                </div>
                <div class="settings-section">
                    <h3>Statistiques Globales (Locales)</h3>
                    <!-- Contenu Stats Globales inchang√© -->
                </div>
                <div class="settings-section">
                    <h3>Statistiques par Quiz (Local)</h3>
                    <!-- Contenu Stats par Quiz inchang√© -->
                </div>
                <div class="settings-section">
                    <h3>Progression & Badges (Local)</h3>
                    <!-- Contenu Gamification/Badges inchang√© (sera mis √† jour par JS) -->
                </div>
            </div>
            <button id="back-to-dashboard-from-settings-btn" class="btn-primary">Retour au Tableau de Bord</button>
        </div>

        <!-- NOUVEAU: √âcran 5: √âditeur de Quiz -->
        <div id="editor-screen" class="screen hidden">
            <div class="card">
                <h2 id="editor-title">Cr√©er / √âditer un Quiz</h2>
                <div id="editor-quiz-meta">
                    <div class="form-group">
                        <label for="edit-quiz-title">Titre du Quiz:</label>
                        <input type="text" id="edit-quiz-title" placeholder="Titre descriptif du quiz">
                    </div>
                    <div class="form-group">
                        <label for="edit-quiz-id">Identifiant Unique (ID):</label>
                        <input type="text" id="edit-quiz-id" placeholder="Ex: chimie-chap1 (alphanum√©rique, tirets)">
                        <p class="info-message small">L'ID ne doit pas √™tre modifi√© apr√®s la cr√©ation si de l'historique
                            existe.</p>
                    </div>
                    <!-- TODO: Ajouter gestion globale des dummyAnswers pour le quiz? -->
                </div>

                <h3 id="editor-questions-header">Questions (0)</h3>
                <div id="editor-question-list">
                    <p>Aucune question. Ajoutez-en une !</p>
                    <!-- Les questions √©ditables seront list√©es ici -->
                    <!-- Exemple d'item de question:
                     <div class="editor-question-item" data-index="0">
                         <span>1. (QCM) Texte de la question...</span>
                         <div class="editor-question-actions">
                            <button class="edit-question-btn">‚úèÔ∏è</button>
                            <button class="delete-question-btn">‚úñÔ∏è</button>
                         </div>
                     </div>
                     -->
                </div>
                <button id="add-question-btn" class="btn-secondary">Ajouter une Question</button>

                <div id="editor-question-form-container" class="hidden">
                    <hr>
                    <h4 id="editor-question-form-title">Ajouter/Modifier Question</h4>
                    <div class="form-group">
                        <label for="edit-question-type">Type de Question:</label>
                        <select id="edit-question-type">
                            <option value="qcm">QCM (Choix unique)</option>
                            <option value="qcm_multi">QCM (Choix Multiple)</option>
                            <option value="vrai_faux">Vrai / Faux</option>
                            <option value="texte_libre">Texte Libre (R√©ponse Courte)</option>
                            <option value="ordre">Mise en Ordre</option>
                            <option value="association">Association</option>
                        </select>
                    </div>
                    <div id="edit-question-fields">
                        <!-- Les champs sp√©cifiques au type de question seront inject√©s ici -->
                        <p>S√©lectionnez un type pour voir les champs...</p>
                    </div>
                    <!-- Champs Communs -->
                    <div class="form-group">
                        <label for="edit-question-text">Texte de la Question (Markdown support√©):</label>
                        <textarea id="edit-question-text" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="edit-question-explanation">Explication (Markdown support√©):</label>
                        <textarea id="edit-question-explanation" rows="2"></textarea>
                    </div>
                    <div class="form-group inline-group">
                        <label for="edit-question-points">Points:</label>
                        <input type="number" id="edit-question-points" value="10" min="0" style="width: 70px;">
                        <label for="edit-question-id">ID Question (Optionnel):</label>
                        <input type="text" id="edit-question-id" placeholder="ID unique si besoin (avanc√©)"
                            style="width: 150px;">
                    </div>
                    <!-- NOUVEAU: Gestion Tags -->
                    <div class="form-group">
                        <label for="edit-question-tags">√âtiquettes (Tags, s√©par√©s par virgule):</label>
                        <input type="text" id="edit-question-tags" placeholder="Ex: anatomie, muscle, jambe">
                    </div>

                    <div class="editor-form-actions">
                        <button id="save-question-btn" class="btn-primary">Sauvegarder Question</button>
                        <button id="cancel-edit-question-btn" class="btn-secondary">Annuler</button>
                    </div>
                </div>

                <div class="editor-main-actions">
                    <button id="save-quiz-btn" class="btn-primary btn-large">Sauvegarder Quiz</button>
                    <button id="cancel-edit-quiz-btn" class="btn-secondary">Retour Dashboard</button>
                </div>
            </div>
        </div>

        <!-- Notifications Globales / Toasts -->
        <div id="toast-notifications" class="toast-container"></div>

        <!-- Loader Global -->
        <div id="global-loader" class="loader-overlay hidden">
            <div class="loader-spinner"></div>
        </div>

    </div> <!-- Fin .container -->

    <script type="module" src="js/main.js"></script>
</body>

</html>